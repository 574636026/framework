package com.injedu.core.supports.excel.util;import java.io.InputStream;import java.util.Iterator;import java.util.List;import java.util.Map;import com.injedu.core.exception.AppException;import com.injedu.core.supports.excel.constant.ExcelConstant;import com.injedu.core.supports.excel.service.ExcelParser;/** * File Import Utility Class */public class FileImportUtils {	/**	 * Get Imported Records for Excel File	 * 	 * @param fileName	 *            导入文件名称	 * @param in	 *            导入文件流	 * @param templateFilePath	 *            模板路径	 * @param templateName	 *            模板名称	 * @param sheetName	 *            需要导入的sheet名称	 * @return List of DTO Converted From Excel File	 * @throws AppException	 */	@SuppressWarnings("unchecked")	public static <T> List<T> getImportedRecords(String fileName, InputStream in, String templateFilePath,			String templateName, String sheetName) throws AppException {		List<T> dtoList = null;		StringBuilder errorMsg = new StringBuilder();		ExcelParser excelParser = ExcelParserFactory.getExcelParser(fileName);		excelParser.parse(in, templateFilePath, templateName);		Map<String, List<String>> sheetErrorMap = excelParser.getErrorMap().get(sheetName);		if (sheetErrorMap == null || sheetErrorMap.isEmpty()) {			Map<String, List<?>> dataMap = excelParser.getDataMap();			dtoList = (List<T>) dataMap.get(sheetName);		} else {			Iterator<String> keys = sheetErrorMap.keySet().iterator();			while (keys.hasNext()) {				String nextKey = keys.next();				errorMsg.append(nextKey);				List<String> values = sheetErrorMap.get(nextKey);				for (Iterator<String> iterator = values.iterator(); iterator.hasNext();) {					String string = (String) iterator.next();					errorMsg.append(string);				}				errorMsg.append(ExcelConstant.Import.EXCEL_IMPORT_LINE_BREAK);			}			throw new AppException(ExcelConstant.Error.EXCEL_FILE_IMPORT_ERROR, errorMsg.toString());		}		return dtoList;	}}